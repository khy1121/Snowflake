# 🔧 설화 정비소: 운영 가이드 (v1.3)

이 문서는 '설화 정비소'의 라이브 운영을 위한 가이드입니다. 신규 모드, 이벤트 로테이션, 현지화(i18n), 릴리즈 체크리스트에 대한 내용을 포함합니다.

---

## 1. 신규 모드 운영

신규 모드('도깨비 야간정비', '망각상회 침투')의 기본 설정은 `src/data/modes.json`에 정의되어 있습니다. 원격 설정을 통해 이 값을 덮어쓸 수 있습니다.

**원격 설정 JSON 예시 (모드 보상 1.5배 이벤트)**:
```json
{
  "modes": [
    {
      "id": "night_maintenance",
      "rewards": {
        "multiplier": 1.5
      }
    }
  ]
}
```

**주요 필드**:
- `dailyEntries`: 일일 입장 횟수
- `duration`: 타임어택 모드 지속 시간 (ms)
- `rounds`: 선택지 모드 라운드 수
- `rewards`: 고정 보상 목록
- `unlockedAt`: 해금되는 스테이지 레벨

---

## 2. 이벤트 로테이션 운영

`EventSchedulerService`를 통해 주간/시즌 이벤트를 자동화할 수 있습니다. 원격 설정으로 이벤트 목록을 전달하면, 서비스가 현재 시간에 맞는 이벤트를 자동으로 활성화합니다.

**원격 설정 JSON 예시 (주간 이벤트 로테이션)**:
```json
{
  "events": [
    {
      "id": "weekly_chase",
      "name": "망각상회 추격전",
      "type": "event",
      "rotation": "weekly",
      "rotationStartDay": 1, // 월요일
      "rotationStartHour": 0, // UTC 0시
      "data": { "description": "이번 주 추격전 보상이 2배!" }
    },
    {
      "id": "weekend_boost",
      "name": "주말 특별 부스트",
      "type": "banner",
      "startAt": 1704499200000,
      "endAt": 1704671999000,
      "data": { "message": "골드 획득량 +20%" }
    }
  ]
}
```

**운영 절차**:
1.  원격 설정에 `events` 배열을 정의합니다.
2.  `rotation: 'weekly'`을 설정하면 매주 지정된 요일/시간에 이벤트가 자동으로 시작/종료됩니다.
3.  `type`에 따라 '이벤트', '모드 보너스', '배너' 등 다양한 형태로 클라이언트에 표시됩니다.
4.  클라이언트는 `getActiveEvents` 함수를 호출하여 현재 활성화된 이벤트 목록을 가져와 UI에 반영합니다.

---

## 3. 현지화(i18n) 추가 방법

새로운 텍스트를 추가하거나 기존 텍스트를 수정할 때 아래 절차를 따릅니다.

1.  **키(Key) 정의**: `home.newFeature`와 같이 점(.)으로 구분된 키를 정의합니다.
2.  **번역 파일 수정**:
    - `src/i18n/ko.json`: 한국어 번역문을 추가합니다. `"home.newFeature": "새로운 기능"`
    - `src/i18n/en.json`: 영어 번역문을 추가합니다. `"home.newFeature": "New Feature"`
3.  **코드에 적용**:
    - UI 컴포넌트에서 `t` 함수를 import 합니다: `import { t } from '../i18n';`
    - 텍스트가 필요한 곳에 `t('home.newFeature')`와 같이 사용합니다.
    - 동적 변수가 필요하면 `t('modes.unlockedAt', { stage: 10 })`와 같이 두 번째 인자로 객체를 전달합니다.

---

## 4. 릴리즈 체크리스트 (v1.3 업데이트)

| ID | 항목 | 확인 내용 |
|---|---|---|
| 1 | **[신규] i18n** | 신규 UI에 번역 키가 누락되지 않았는지 확인 (하드코딩된 문자열 금지) |
| 2 | **[신규] 이벤트 시간** | 이벤트 시작/종료 시간이 현지 타임존(Asia/Seoul) 기준으로 올바르게 표시되는지 확인 |
| 3 | **[신규] 모드 리셋** | 일일 입장 제한 횟수가 UTC 0시 기준으로 정상적으로 리셋되는지 확인 |
| 4 | **[검증] 원격 설정** | 앱 실행 시 원격 설정을 가져오지 못했을 때, 로컬 폴백 데이터로 정상 동작하는지 확인 |
| 5 | **[검증] 마이그레이션** | 이전 버전(v1.2)에서 업데이트 시 데이터 손실 없이 V8 마이그레이션이 완료되는지 확인 |
| 6 | **[검증] 성능** | 신규 모드 진입/종료 시 메모리 누수나 급격한 FPS 저하가 없는지 확인 |
| 7 | **[검증] 테스트** | 추가된 유닛 테스트 15개 이상이 모두 통과하는지 확인 |
| 8 | **[검증] 빌드** | Android/iOS 릴리즈 빌드가 정상적으로 생성되고 실행되는지 확인 |
