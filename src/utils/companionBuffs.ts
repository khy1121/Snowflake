/**\n * 동료 버프 적용 유틸리티\n * 전투, 경제, 오프라인 계산에 반영\n */\n\nimport { calculateCompanionBuffs } from '@/features/progression/companionEngine';\nimport { CompanionProgress } from '@/types';\n\n/**\n * 동료 버프를 포함한 최종 스탯 계산\n */\nexport function calculateStatsWithCompanionBuffs(\n  baseAtk: number,\n  baseHp: number,\n  upgradeLevels: Record<string, number>,\n  companionProgress: Record<string, CompanionProgress>\n) {\n  const buffs = calculateCompanionBuffs(companionProgress);\n\n  // 기본 스탯 계산 (기존 로직)\n  const baseStats = {\n    atk: baseAtk,\n    hp: baseHp,\n    attackSpeed: 300,\n    critChance: 0,\n    critDamage: 1,\n    offlineEfficiency: 1,\n  };\n\n  // 동료 버프 적용 (퍼센트 증가)\n  return {\n    atk: Math.floor(baseStats.atk * (1 + buffs.atk)),\n    hp: Math.floor(baseStats.hp * (1 + buffs.hp)),\n    attackSpeed: baseStats.attackSpeed,\n    critChance: Math.min(baseStats.critChance + buffs.critChance, 1),\n    critDamage: baseStats.critDamage + buffs.critDamage,\n    offlineEfficiency: baseStats.offlineEfficiency * (1 + buffs.offlineEfficiency),\n  };\n}\n\n/**\n * 동료 버프를 포함한 골드 획득량\n */\nexport function calculateGoldWithCompanionBuffs(\n  baseGold: number,\n  companionProgress: Record<string, CompanionProgress>\n): number {\n  const buffs = calculateCompanionBuffs(companionProgress);\n  return Math.floor(baseGold * (1 + buffs.goldGain));\n}\n\n/**\n * 동료 버프를 포함한 오프라인 보상\n */\nexport function calculateOfflineRewardWithCompanionBuffs(\n  baseReward: number,\n  companionProgress: Record<string, CompanionProgress>\n): number {\n  const buffs = calculateCompanionBuffs(companionProgress);\n  return Math.floor(baseReward * buffs.offlineEfficiency);\n}\n\n/**\n * 모든 동료 버프 요약 (UI용)\n */\nexport function getCompanionBuffsSummary(\n  companionProgress: Record<string, CompanionProgress>\n): Array<{ type: string; value: string; description: string }> {\n  const buffs = calculateCompanionBuffs(companionProgress);\n  const summary = [];\n\n  if (buffs.goldGain > 0) {\n    summary.push({\n      type: 'goldGain',\n      value: `+${(buffs.goldGain * 100).toFixed(0)}%`,\n      description: '골드 획득량',\n    });\n  }\n\n  if (buffs.hp > 0) {\n    summary.push({\n      type: 'hp',\n      value: `+${(buffs.hp * 100).toFixed(0)}%`,\n      description: '생명력',\n    });\n  }\n\n  if (buffs.atk > 0) {\n    summary.push({\n      type: 'atk',\n      value: `+${(buffs.atk * 100).toFixed(0)}%`,\n      description: '공격력',\n    });\n  }\n\n  if (buffs.critChance > 0) {\n    summary.push({\n      type: 'critChance',\n      value: `+${(buffs.critChance * 100).toFixed(0)}%`,\n      description: '크리티컬 확률',\n    });\n  }\n\n  if (buffs.critDamage > 0) {\n    summary.push({\n      type: 'critDamage',\n      value: `+${(buffs.critDamage * 100).toFixed(0)}%`,\n      description: '크리티컬 데미지',\n    });\n  }\n\n  if (buffs.offlineEfficiency > 0) {\n    summary.push({\n      type: 'offlineEfficiency',\n      value: `+${(buffs.offlineEfficiency * 100).toFixed(0)}%`,\n      description: '오프라인 효율',\n    });\n  }\n\n  return summary;\n}\n
