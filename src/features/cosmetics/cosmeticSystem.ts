/**\n * 코스튬(Cosmetic) 시스템\n * 외형 아이템 획득, 장착, 관리\n */\n\nimport cosmetics from '@/data/cosmetics.json';\n\nexport interface CosmeticProgress {\n  cosmeticId: string;\n  isOwned: boolean;\n  isEquipped: boolean;\n  ownedAt: number | null;\n}\n\n/**\n * 코스튬 초기화\n */\nexport function initializeCosmetics(): Record<string, CosmeticProgress> {\n  const progress: Record<string, CosmeticProgress> = {};\n\n  cosmetics.cosmetics.forEach((cosmetic) => {\n    progress[cosmetic.cosmeticId] = {\n      cosmeticId: cosmetic.cosmeticId,\n      isOwned: cosmetic.obtainMethod === 'free',\n      isEquipped: cosmetic.cosmeticId === 'skin_basic_blue', // 기본 스킨 장착\n      ownedAt: cosmetic.obtainMethod === 'free' ? Date.now() : null,\n    };\n  });\n\n  return progress;\n}\n\n/**\n * 코스튬 구매\n */\nexport function purchaseCosmetic(\n  progress: Record<string, CosmeticProgress>,\n  cosmeticId: string,\n  currentCosmeticTokens: number\n): { updated: Record<string, CosmeticProgress>; success: boolean; tokensUsed: number } {\n  const updated = { ...progress };\n  const cosmetic = cosmetics.cosmetics.find((c) => c.cosmeticId === cosmeticId);\n\n  if (!cosmetic || updated[cosmeticId]?.isOwned) {\n    return { updated, success: false, tokensUsed: 0 };\n  }\n\n  if (cosmetic.costType !== 'cosmeticToken') {\n    return { updated, success: false, tokensUsed: 0 };\n  }\n\n  if (currentCosmeticTokens < cosmetic.cost) {\n    return { updated, success: false, tokensUsed: 0 };\n  }\n\n  updated[cosmeticId] = {\n    ...updated[cosmeticId],\n    isOwned: true,\n    ownedAt: Date.now(),\n  };\n\n  return { updated, success: true, tokensUsed: cosmetic.cost };\n}\n\n/**\n * 코스튬 장착\n */\nexport function equipCosmetic(\n  progress: Record<string, CosmeticProgress>,\n  cosmeticId: string,\n  cosmeticType: string\n): Record<string, CosmeticProgress> {\n  const updated = { ...progress };\n\n  if (!updated[cosmeticId]?.isOwned) {\n    return updated;\n  }\n\n  // 같은 타입의 다른 코스튬 해제\n  const cosmetic = cosmetics.cosmetics.find((c) => c.cosmeticId === cosmeticId);\n  if (cosmetic) {\n    cosmetics.cosmetics.forEach((c) => {\n      if (\n        c.type === cosmetic.type &&\n        c.cosmeticId !== cosmeticId &&\n        updated[c.cosmeticId]?.isEquipped\n      ) {\n        updated[c.cosmeticId].isEquipped = false;\n      }\n    });\n  }\n\n  updated[cosmeticId].isEquipped = true;\n\n  return updated;\n}\n\n/**\n * 코스튬 해제\n */\nexport function unequipCosmetic(\n  progress: Record<string, CosmeticProgress>,\n  cosmeticId: string\n): Record<string, CosmeticProgress> {\n  const updated = { ...progress };\n\n  if (updated[cosmeticId]) {\n    updated[cosmeticId].isEquipped = false;\n  }\n\n  return updated;\n}\n\n/**\n * 현재 장착된 코스튬 조회 (타입별)\n */\nexport function getEquippedCosmetic(\n  progress: Record<string, CosmeticProgress>,\n  cosmeticType: string\n) {\n  for (const cosmetic of cosmetics.cosmetics) {\n    if (\n      cosmetic.type === cosmeticType &&\n      progress[cosmetic.cosmeticId]?.isEquipped\n    ) {\n      return cosmetic;\n    }\n  }\n\n  // 기본 코스튬 반환\n  if (cosmeticType === 'playerSkin') {\n    return cosmetics.cosmetics.find((c) => c.cosmeticId === 'skin_basic_blue');\n  }\n\n  return null;\n}\n\n/**\n * 코스튬 데이터 조회\n */\nexport function getCosmeticData(cosmeticId: string) {\n  return cosmetics.cosmetics.find((c) => c.cosmeticId === cosmeticId);\n}\n\n/**\n * 모든 코스튬 데이터 조회\n */\nexport function getAllCosmetics() {\n  return cosmetics.cosmetics;\n}\n\n/**\n * 타입별 코스튬 조회\n */\nexport function getCosmeticsByType(cosmeticType: string) {\n  return cosmetics.cosmetics.filter((c) => c.type === cosmeticType);\n}\n\n/**\n * 보유 코스튬 목록\n */\nexport function getOwnedCosmetics(\n  progress: Record<string, CosmeticProgress>\n) {\n  return cosmetics.cosmetics.filter((c) => progress[c.cosmeticId]?.isOwned);\n}\n\n/**\n * 구매 가능한 코스튬 목록\n */\nexport function getShopCosmetics() {\n  return cosmetics.cosmetics.filter(\n    (c) => c.obtainMethod === 'shop' && c.costType === 'cosmeticToken'\n  );\n}\n
