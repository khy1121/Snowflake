/**\n * 이벤트 스케줄러 유닛 테스트\n */\n\nimport {\n  getWeekStartTime,\n  getWeekEndTime,\n  isEventActive,\n  getRotationInstanceTiming,\n  getActiveEvents,\n  getNextEvent,\n  createWeeklyEventTemplate,\n  formatTimeRemaining,\n} from '../services/EventSchedulerService';\n\ndescribe('Event Scheduler', () => {\n  describe('Week Timing', () => {\n    test('getWeekStartTime should return Monday 00:00', () => {\n      const date = new Date('2024-01-10T15:30:00Z'); // Wednesday\n      const weekStart = getWeekStartTime(date, 1, 0);\n      expect(weekStart.getUTCDay()).toBe(1); // Monday\n      expect(weekStart.getUTCHours()).toBe(0);\n      expect(weekStart.getUTCMinutes()).toBe(0);\n    });\n\n    test('getWeekEndTime should return next Monday 00:00', () => {\n      const date = new Date('2024-01-10T15:30:00Z'); // Wednesday\n      const weekEnd = getWeekEndTime(date, 1, 0);\n      expect(weekEnd.getUTCDay()).toBe(1); // Monday\n      const diff = (weekEnd.getTime() - getWeekStartTime(date, 1, 0).getTime()) / (1000 * 60 * 60);\n      expect(diff).toBe(168); // 7 days\n    });\n  });\n\n  describe('Event Activity', () => {\n    test('isEventActive should return true for active event', () => {\n      const now = Date.now();\n      const event = {\n        id: 'test',\n        name: 'Test Event',\n        type: 'event' as const,\n        startAt: now - 1000,\n        endAt: now + 1000,\n      };\n      expect(isEventActive(event, now)).toBe(true);\n    });\n\n    test('isEventActive should return false for future event', () => {\n      const now = Date.now();\n      const event = {\n        id: 'test',\n        name: 'Test Event',\n        type: 'event' as const,\n        startAt: now + 1000,\n        endAt: now + 2000,\n      };\n      expect(isEventActive(event, now)).toBe(false);\n    });\n\n    test('isEventActive should return false for past event', () => {\n      const now = Date.now();\n      const event = {\n        id: 'test',\n        name: 'Test Event',\n        type: 'event' as const,\n        startAt: now - 2000,\n        endAt: now - 1000,\n      };\n      expect(isEventActive(event, now)).toBe(false);\n    });\n  });\n\n  describe('Rotation Events', () => {\n    test('getRotationInstanceTiming should calculate weekly timing', () => {\n      const now = Date.now();\n      const event = {\n        id: 'test',\n        name: 'Test Event',\n        type: 'event' as const,\n        startAt: now - 100000,\n        endAt: now + 100000,\n        rotation: 'weekly' as const,\n        rotationStartDay: 1,\n        rotationStartHour: 0,\n      };\n      const timing = getRotationInstanceTiming(event, now);\n      expect(timing.startAt).toBeLessThanOrEqual(now);\n      expect(timing.endAt).toBeGreaterThan(now);\n    });\n  });\n\n  describe('Active Events', () => {\n    test('getActiveEvents should return only active events', () => {\n      const now = Date.now();\n      const events = [\n        {\n          id: 'active',\n          name: 'Active Event',\n          type: 'event' as const,\n          startAt: now - 1000,\n          endAt: now + 1000,\n        },\n        {\n          id: 'future',\n          name: 'Future Event',\n          type: 'event' as const,\n          startAt: now + 86400000,\n          endAt: now + 86400000 + 1000,\n        },\n        {\n          id: 'past',\n          name: 'Past Event',\n          type: 'event' as const,\n          startAt: now - 86400000,\n          endAt: now - 86400000 + 1000,\n        },\n      ];\n      const active = getActiveEvents(events, now);\n      expect(active.length).toBeGreaterThanOrEqual(1);\n      expect(active.some((e) => e.id === 'active')).toBe(true);\n    });\n  });\n\n  describe('Next Event', () => {\n    test('getNextEvent should return earliest upcoming event', () => {\n      const now = Date.now();\n      const events = [\n        {\n          id: 'event1',\n          name: 'Event 1',\n          type: 'event' as const,\n          startAt: now + 3600000,\n          endAt: now + 7200000,\n        },\n        {\n          id: 'event2',\n          name: 'Event 2',\n          type: 'event' as const,\n          startAt: now + 1800000,\n          endAt: now + 3600000,\n        },\n      ];\n      const next = getNextEvent(events, now);\n      expect(next?.id).toBe('event2');\n    });\n\n    test('getNextEvent should return null when no upcoming events', () => {\n      const now = Date.now();\n      const events = [\n        {\n          id: 'past',\n          name: 'Past Event',\n          type: 'event' as const,\n          startAt: now - 3600000,\n          endAt: now - 1800000,\n        },\n      ];\n      const next = getNextEvent(events, now);\n      expect(next).toBeNull();\n    });\n  });\n\n  describe('Event Template', () => {\n    test('createWeeklyEventTemplate should create valid template', () => {\n      const event = createWeeklyEventTemplate(\n        'test',\n        'Test Event',\n        'event',\n        1,\n        0\n      );\n      expect(event.id).toBe('test');\n      expect(event.rotation).toBe('weekly');\n      expect(event.rotationStartDay).toBe(1);\n      expect(event.rotationStartHour).toBe(0);\n    });\n  });\n\n  describe('Time Formatting', () => {\n    test('formatTimeRemaining should format days', () => {\n      const ms = 86400000 + 3600000; // 1 day 1 hour\n      const formatted = formatTimeRemaining(ms);\n      expect(formatted).toContain('일');\n      expect(formatted).toContain('시간');\n    });\n\n    test('formatTimeRemaining should format hours', () => {\n      const ms = 3600000 + 60000; // 1 hour 1 minute\n      const formatted = formatTimeRemaining(ms);\n      expect(formatted).toContain('시간');\n      expect(formatted).toContain('분');\n    });\n\n    test('formatTimeRemaining should format minutes', () => {\n      const ms = 60000 + 1000; // 1 minute 1 second\n      const formatted = formatTimeRemaining(ms);\n      expect(formatted).toContain('분');\n      expect(formatted).toContain('초');\n    });\n\n    test('formatTimeRemaining should format seconds', () => {\n      const ms = 30000; // 30 seconds\n      const formatted = formatTimeRemaining(ms);\n      expect(formatted).toContain('초');\n    });\n  });\n});\n
